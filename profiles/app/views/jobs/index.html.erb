
<div class = "filter-container">
<span>Filter this list by skill</span>
	<form name="skill-list">
		<% @skills.each do |skill| %>
		<label for="<%= skill.name %>"><%= skill.name %></label>
		<input type="checkbox" name="<%= skill.name %>" value="<%= skill.id %>">
		<br>
		<% end %>
	</form>
</div>
<div id="listing-container"></div>
<script id="jobs-template" type="x-tmpl-mustache">
	{{#jobs}}
		<h1>{{user_id}} is looking for a {{title}}</h1>
		<p>{{desc}}   <a href="/jobs/{{id}}">Read more</a></p> 
		<span>
				{{#skills}}
					{{name}}
				{{/skills}}
		</span>

	{{/jobs}}
</script>


<script>
//the master list of jobs
	var jobsArray = {jobs :<%=raw @jobs.to_json(:include => :skills) %>}


var checkJob = function(job,skill){
	var found = false;
	for (var i = 0; i < job.skills.length; i++){
		if (job.skills[i].name === skill){
			found = true;
		}
	}
	return found;
}

var showChecked = function(skill,jobs){ 
	var jobs = jobs.jobs.filter(checkJob(jobs,skill));
	
}

//rendering the filtered job list to the page
var renderJobs = function(jobList){
	$('#listing-container').text('')
	var template = $('#jobs-template').html()
	var render = Mustache.render(template, jobList)
	$('#listing-container').append(render)
}

renderJobs(jobsArray)


$("[type=checkbox]").on('click',function(event){
	showSkill = event.target.name
	showChecked(showSkill, jobsArray)
});

</script>


